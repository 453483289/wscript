<!doctype html>
<html>
<head>
<script src="Tracing.js"></script>
<script src="WScript.js"></script>
</head>
<body>
<textarea id="wscript-input" style="width:400px;height:300px">
var shell = WScript.CreateObject("WScript.Shell");
var tmpFolder = shell.ExpandEnvironmentStrings("%TEMP%\\");
WScript.Echo(tmpFolder);
</textarea>
<button id="run">Run</button>
<code><pre id="out"></pre></code>
<script>
function prettyPrint (obj) {
    return JSON.stringify(obj, function(key, value) {
        if (value !== value) {
            return "NaN";
        }

        if (typeof(value) == "function") {
            return value.toString();
        }

        return value;
    });
}

var wscriptinput = document.getElementById('wscript-input'),
    out = document.getElementById('out');

var traceBefore = function(fnName) {
    Tracing.before(fnName, function(fnName, parameters, depth) {
        parameters = parameters.map(prettyPrint);

        out.innerHTML = out.innerHTML + "\n>" + (new Array(depth + 1)).join("  ") +
            fnName +
            " called with arguments: (" +
            parameters.join(", ") + ")";
    });
}

var traceAfter = function(fnName) {
    Tracing.after(fnName, function(fnName, returnVal, depth) {
            out.innerHTML = out.innerHTML + "\n>" + (new Array(depth + 1)).join("  ") +         // indentation
                fnName + " returned: " + prettyPrint(returnVal); // return value
        });
}

var fns = {};

var loop = function(obj) {
    if (!fns[obj]) fns[obj]
    for (var fn in obj) {
        if (typeof obj[fn] === 'function') {
            var objName = 'Windows Script Host' === obj.toString() ? 'WScript' : objname;
            traceBefore([objName,fn].join('.'));
        }
    }
}

//loop(WScript);

for (var fn in WScript) {
	if (typeof WScript[fn] === 'function') {
        traceBefore('WScript.' + fn);
        traceAfter('WScript.' + fn);
	}
}

document.getElementById('run').addEventListener('click', function(e) {
    e.preventDefault();

    out.innerHTML = '';
    eval(wscriptinput.value);
});
</script>
</body>
</html>